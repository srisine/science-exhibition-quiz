<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Modernity of History!</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="splash-screen">
        <h1>MODERNITY OF HISTORY</h1>
        <p>Prepare yourself…</p>
    </div>
    <div class="quiz" style="display: none;">
        <div class="ques">
            <h1 id="qno"><u>QUESTION</u></h1>
            <h2 id="qnobody"></h2>
        </div>
        <div class="options">
            <button id="option1" data-index="0"></button>
            <button id="option2" data-index="1"></button>
            <button id="option3" data-index="2"></button>
            <button id="option4" data-index="3"></button>
        </div>
    </div>
</body>
<script>
function setCookie(name, value, days = 365) {
    const d = new Date();
    d.setTime(d.getTime() + days*24*60*60*1000);
    const expires = "expires=" + d.toUTCString();
    document.cookie = `${name}=${value};${expires};path=/`;
}

function getCookie(name) {
    const cname = name + "=";
    const decoded = decodeURIComponent(document.cookie);
    const ca = decoded.split(';');
    for(let i = 0; i < ca.length; i++) {
        let c = ca[i].trim();
        if (c.indexOf(cname) === 0) return c.substring(cname.length, c.length);
    }
    return null;
}

// Get attempts and increment if less than max
let attempts = parseInt(getCookie("quizAttempts")) || 0;
const maxAttempts = 3;

if(attempts < maxAttempts){
    attempts += 1;
    setCookie("quizAttempts", attempts, 365);
}

window.addEventListener("DOMContentLoaded", () => {
    const splash = document.getElementById("splash-screen");
    const quiz = document.querySelector(".quiz");

    setTimeout(() => {
        splash.style.opacity = 0;
        setTimeout(() => {
            splash.style.display = "none";
            quiz.style.display = "block";
            updateQuizDisplay();
        }, 1000);
    }, 2500);
});

var attempsDOM = document.getElementById('attempts');
var quesNo = document.getElementById('qno');
var quesBody = document.getElementById('qnobody');
var op1 = document.getElementById('option1');
var op2 = document.getElementById('option2');
var op3 = document.getElementById('option3');
var op4 = document.getElementById('option4');

var result = [0, 0, 0, 0, 0];

const quizData = [
    { question: "Which torture device stretched victims’ limbs?", options: ["The Rack", "The Wheel", "The Iron Maiden", "The Stocks"], answer: "The Rack" },
    { question: "Which method used rats to torture prisoners?", options: ["The Brazen Bull", "Rat Torture", "The Pendulum", "Scaphism"], answer: "Rat Torture" },
    { question: "Which device crushed the body with iron weights?", options: ["Pressing Bench", "The Rack", "Thumbscrew", "Iron Maiden"], answer: "Pressing Bench" }
];

var quesIdx = 0;

function loadQuestion(idx){
    const q = quizData[idx];
    quesNo.innerText = `QUESTION ${idx + 1}`;
    quesBody.innerText = q.question;

    op1.innerText = q.options[0];
    op2.innerText = q.options[1];
    op3.innerText = q.options[2];
    op4.innerText = q.options[3];

    const buttons = document.querySelectorAll(".options button");
    buttons.forEach(btn => {
        btn.disabled = false;
        btn.style.display = "block";
        btn.style.backgroundColor = "";
    });
}

function updateQuizDisplay(){
    if(attempts > maxAttempts){
        quesNo.innerText = `You have reached the maximum of ${maxAttempts} attempts.`;
        attempsDOM.innerText = "";
        buttons.forEach(btn => btn.disabled = true);
    } else {
        attempsDOM.innerText = `Attempt ${attempts} of ${maxAttempts}`;
        loadQuestion(quesIdx);
        attachButtonEvents();
    }
}

const buttons = document.querySelectorAll(".options button");

function attachButtonEvents(){
    buttons.forEach(button => {
        button.addEventListener("click", function(e){
            const index = parseInt(this.dataset.index);
            const correctIndex = quizData[quesIdx].options.indexOf(quizData[quesIdx].answer);

            result.push(index === correctIndex ? 1 : 0);

            // Blood splatter
            const splatter = document.createElement("div");
            splatter.classList.add("blood-splatter");
            splatter.style.left = `${e.clientX - 10}px`;
            splatter.style.top = `${e.clientY - 10}px`;
            document.body.appendChild(splatter);
            splatter.addEventListener("animationend", () => splatter.remove());

            // Disable buttons temporarily
            buttons.forEach(btn => btn.disabled = true);

            setTimeout(() => {
                quesIdx++;
                if(quesIdx < quizData.length) loadQuestion(quesIdx);
                else {
                    quesNo.innerText = "Quiz Completed!";
                    quesBody.innerText = `Your score: ${result.reduce((a,b)=>a+b,0)}/${quizData.length}`;
                }
            }, 800);
        });
    });
}
</script>

</html>

